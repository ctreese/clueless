<!DOCTYPE html>
<html>
<head>
<title>Clueless Client Demo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
<script src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.9.0.js"></script>
<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/knockout/knockout-2.2.1.js"></script>
</head>
<body>
    <div class="navbar">
        <div class="navbar-inner">
            <a class="brand" href="#">Clueless Client Demo</a>
        </div>
    </div>
    <div class="container">
      <label>Enter your game server IP here:</label>
      <input type="text" id="server-ip" value="10.0.0.19" />
      <label>Enter your game server port here:</label>
      <input type="text" id="server-port" value="8000" />
    </div>

    <div class="container">
      <label>Current Game State</label>
      <div id="game-state-container">
        FILLER CONSOLE OUTPUT
      </div>
    </div>
    <div id="main" class="container">
      <table class="table table-striped">
        <tr>
          <td style="width: 1px;"></td>
          <td><b>Client Request</b></td>
          <td><b>Client Input</b></td>
          <td><b>Server Output</b></td>
        </tr>
			  <tr>
  				<td style="width: 1px;"></td>
  				<td>
            <button class="btn" id="register-button">Register</button>
          </td>
          <td></td>
          <td>
            <p><b id="register-response"></b></p>
          </td>
        </tr>
			  <tr>
  				<td style="width: 1px;"></td>
  				<td>
            <button class="btn" id="move-button">Move</button>
          </td>
          <td>
            <label>Enter your move number here</label>
            <input type="text" id="move-number" value="1" />
          </td>
          <td></td>
          <td><p><b id="move-response"></b></p></td>
        </tr>
        <tr>
          <td style="width: 1px;"></td>
          <td>
            <button class="btn" id="game-state-button">Start</button>
          </td>
          <td></td>
          <td><p><b id="game-state-response"></b></p></td>
        </tr>
        <tr>
          <td style="width: 1px;"></td>
          <td>
            <button class="btn" id="start-button">Start</button>
          </td>
          <td></td>
          <td><p><b id="start-response"></b></p></td>
        </tr>
        </table>
    </div>
    <script type="text/javascript">

      function update_data() {
        player_name = document.getElementById('register-response').innerHTML
        ip_address = document.getElementById('server-ip').value
        port = document.getElementById('server-port').value
        move_number = document.getElementById('move-number').value
        move_data = {
          player_name: player_name,
          move: move_number
        }
        start_data = {
          player_name: player_name
        }
        game_state_data = {
          player_name: player_name
        }
      }
  		function register() {
        update_data()
  			if(!player_name) {
  				$.ajax({
  					url: `http://${ip_address}:${port}/register`,
  					type: 'GET',
  					//data: 'ID=1&Name=John&Age=10', // or $('#myform').serializeArray()
  					success: function(data) {
  						player_name = data.player_name;
  						var register_output = 'Playings as: ' + player_name;
  						document.getElementById('register-response').innerHTML = register_output;
            }
  				});
  			}
  		}
      function move() {
        update_data()
        $.ajax({
          url: `http://${ip_address}:${port}/move/`,
          type: 'POST',
          data: move_data,
          success: function(data) {
            var move_output = player_name + data.move;
            document.getElementById('move-text').innerHTML = move_output;
          }
        });
      }
      function game_state() {
        update_data()
        $.ajax({
          url: `http://${ip_address}:${port}/game_state`,
          type: 'POST',
          data: game_state_data,
          success: function(data) {
            document.getElementById('start-response').innerHTML = data;
          }
        });
      }
  		function move() {
        update_data()
  			$.ajax({
  				url: `http://${ip_address}:${port}/move/`,
  				type: 'POST',
          data: move_data,
  				success: function(data) {
    				var move_output = player_name + data.move;
    				document.getElementById('move-text').innerHTML = move_output;
  				}
  			});
  		}
  		function start() {
        update_data()
  			$.ajax({
  				url: `http://${ip_address}:${port}/start`,
  				type: 'GET',
  				success: function(data) {
    				var available_characters = data.info;
    				var start_output = "You are playing the skeletal version of Clueless. Available players are: " + available_characters
    				document.getElementById('start-response').innerHTML = data.message;
          }
  			});
  		}

      let player_name = document.getElementById('register-response').innerHTML;
      let ip_address = document.getElementById('server-ip').value;
      let port = document.getElementById('server-port').value;
      let move_number = document.getElementById('move-number').value;
      let move_data = {
        player_name: player_name,
        move: move_number
      };
      let start_data = {
        player_name: player_name
      };
      let game_state_data = {
        player_name: player_name
      };

      $(document).ready(function() {
        $('#register-button').click(register);
        $('#move-button').click(move);
        $('#start-button').click(start);
      });

    </script>
</body>
</html>
